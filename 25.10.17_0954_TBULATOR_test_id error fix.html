<!--
ì•„ë˜ëŠ” ë“œë¡­ë‹¤ìš´/ê²€ì¦/í¬ë§¤í„° ëª¨ë‘ ì œê±°í•˜ê³ , ì—‘ì…€ì²˜ëŸ¼ ì•„ë¬´ í…ìŠ¤íŠ¸ë‚˜ ì…ë ¥ë˜ë„ë¡ ì†ë³¸ ë²„ì „ì…ë‹ˆë‹¤.
ë˜í•œ Ctrl+C ë¡œ ë²”ìœ„ ë³µì‚¬ê°€ ë°”ë¡œ ë˜ë„ë¡(ë²„íŠ¼ ì—†ì´) í…Œì´ë¸” ì˜ì—­ì—ì„œ keydownì„ ê°€ë¡œì±„ table.copyToClipboard("selected") ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
(ë¶™ì—¬ë„£ê¸°ëŠ” ì…€ì„ í•œ ë²ˆ í´ë¦­í•œ ë’¤ Ctrl+V ë¡œ ë©ë‹ˆë‹¤. clipboard: true, clipboardPasteAction:"update" ìœ ì§€)

ì½”ë“œ ì•ˆì— ìì„¸í•œ í•œê¸€ ì£¼ì„ì„ ë„£ì–´ë‘ì—ˆìŠµë‹ˆë‹¤.
-->

<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>Tabulator: ì—‘ì…€ì²˜ëŸ¼ ììœ  ì…ë ¥</title>

  <!-- Tabulator CSS -->
  <link href="https://unpkg.com/tabulator-tables@latest/dist/css/tabulator.min.css" rel="stylesheet">

  <style>
    /* ë°ëª¨ìš© ìµœì†Œ ìŠ¤íƒ€ì¼ */
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; }
    .toolbar { display:flex; gap:8px; margin-bottom:12px; flex-wrap: wrap; }
    #table { height: 420px; } /* ê³ ì • ë†’ì´: ê°€ìƒ ìŠ¤í¬ë¡¤ í™œì„±í™” */
    .note { color:#555; font-size: 13px; margin-top: 8px; }
    .search { width: 220px; padding: 6px 8px; }
    button { padding: 6px 10px; border:1px solid #ddd; background:#f7f7f7; border-radius:6px; cursor:pointer; }
    button:hover { background:#eee; }
  </style>
</head>
<body>

  <h1>Tabulator ë°”ë‹ë¼ JS â€” ì—‘ì…€ì²˜ëŸ¼ ììœ  ì…ë ¥</h1>

  <div class="toolbar">
    <!-- ê²€ìƒ‰ ì…ë ¥ (í•„ìš” ì—†ìœ¼ë©´ ì‚­ì œí•´ë„ ë¨) -->
    <input id="search" class="search" type="text" placeholder="ì´ë¦„/ë„ì‹œ ê²€ìƒ‰ (ì‹¤ì‹œê°„ í•„í„°)" />

    <!-- í–‰ ì¡°ì‘ -->
    <button id="add-row">í–‰ ì¶”ê°€</button>
    <button id="del-row">ì„ íƒ í–‰ ì‚­ì œ</button>

    <!-- ë‚´ë³´ë‚´ê¸° -->
    <button id="export-csv">CSV ë‚´ë³´ë‚´ê¸°</button>
  </div>

  <!-- í…Œì´ë¸” ì»¨í…Œì´ë„ˆ -->
  <div id="table" tabindex="0"></div>
  <div class="note">
    Tip: <b>ë²”ìœ„ ë“œë˜ê·¸ â†’ Ctrl+C</b>ë¡œ ë³µì‚¬, ì…€ì„ í•œ ë²ˆ í´ë¦­í•˜ê³  <b>Ctrl+V</b>ë¡œ ë¶™ì—¬ë„£ê¸°.<br/>
    (ì´ ì˜ˆì‹œëŠ” ë²„íŠ¼ ì—†ì´ë„ Ctrl+Cê°€ ë™ì‘í•˜ë„ë¡ í‚¤ ì´ë²¤íŠ¸ë¥¼ ì—°ê²°í–ˆìŠµë‹ˆë‹¤)
  </div>

  <!-- Tabulator JS -->
  <script src="https://unpkg.com/tabulator-tables@latest/dist/js/tabulator.min.js"></script>

  <script>
    // ---------------------------
    // ë°ëª¨ìš© ì´ˆê¸° ë°ì´í„°
    // ---------------------------
    const tableData = [
      { _rid: "r1", id:"1", name:"í™ê¸¸ë™", age:"29", city:"ì„œìš¸",   join:"2024-10-01", score:"83" },
      { _rid: "r2", id:"2", name:"ê¹€ì•„ë¦„", age:"32", city:"ë¶€ì‚°",   join:"2023-07-12", score:"91" },
      { _rid: "r3", id:"3", name:"ì´ì¤€í˜¸", age:"26", city:"ëŒ€êµ¬",   join:"2025-01-10", score:"75" },
      { _rid: "r4", id:"4", name:"ë°•ì§€ë¯¼", age:"41", city:"ì¸ì²œ",   join:"2022-03-30", score:"88" },
    ];

    // ---------------------------
    // Tabulator ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    // ---------------------------
    const table = new Tabulator("#table", {
      // ê¸°ë³¸ ë°ì´í„°/í‚¤
      data: tableData,                  // ì´ˆê¸° ë°ì´í„°
      index: "_rid",              // âœ… ë‚´ë¶€ìš© ê³ ìœ í‚¤(í™”ë©´ì— ì•ˆ ë³´ì´ê²Œ ì‚¬ìš©)

      // ë ˆì´ì•„ì›ƒ/í–‰ë†’ì´
      layout: "fitColumns",             // ì»¬ëŸ¼ ë„ˆë¹„ ìë™ë§ì¶¤
      height: "420px",                  // ê°€ìƒ ìŠ¤í¬ë¡¤
      selectable: true,                 // í–‰ ì„ íƒ ê°€ëŠ¥

      // ìƒí˜¸ì‘ìš© ê¸°ë³¸ ì˜µì…˜
      movableColumns: true,             // ì»¬ëŸ¼ ë“œë˜ê·¸ë¡œ ìˆœì„œë³€ê²½
      resizableRows: true,              // í–‰ë†’ì´ ì¡°ì ˆ

      // ğŸ”’ ì—‘ì…€ì²˜ëŸ¼ ììœ  ë³µë¶™
      clipboard: true,                  // í´ë¦½ë³´ë“œ(ë³µë¶™) í™œì„±í™”
      clipboardPasteAction: "update",   // ë¶™ì—¬ë„£ê¸° ì‹œ ê¸°ì¡´ ì…€ ì—…ë°ì´íŠ¸

      // âœ… ì…€ ë²”ìœ„ ì„ íƒ(ì—‘ì…€ì‹ ë“œë˜ê·¸)
      selectableRange: true,            // ì…€ ë“œë˜ê·¸ë¡œ ì—¬ëŸ¬ ê°œ ì„ íƒ
      selectableRangeColumns: true,     // ì»¬ëŸ¼(ì…€) ë‹¨ìœ„ ì„ íƒ í—ˆìš©
      selectableRangeRows: true,        // í–‰ ë‹¨ìœ„ ì„ íƒ í—ˆìš©
      selectableRangeMode: "cell",      // 'cell' ëª¨ë“œì—ì„œ ë‹¤ì¤‘ ì…€ ì„ íƒ

      // âœ… ì—‘ì…€ ëŠë‚Œ: í´ë¦­ìœ¼ë¡œ í¸ì§‘ ì‹œì‘(ì•„ë¬´ í…ìŠ¤íŠ¸ ì…ë ¥ ê°€ëŠ¥)
      editTriggerEvent: "dblclick",

      // âœ… ì»¬ëŸ¼ ì •ì˜: ì „ë¶€ editor:"input" ìœ¼ë¡œ ììœ  ì…ë ¥
      //    - ë“œë¡­ë‹¤ìš´/ìœ íš¨ì„±ê²€ì‚¬/í¬ë§¤í„° ì œê±°
      columns: [
        // (ì„ íƒ) ë‚´ë¶€í‚¤ ì»¬ëŸ¼ì„ ìˆ¨ê¸°ê³  ì‹¶ìœ¼ë©´ visible:false
        { title:"_rid", field:"_rid", visible:false }, // âœ… í™”ë©´ ë¹„í‘œì‹œ

        // í™”ë©´ì— ë³´ì´ëŠ” ID: ììœ  ì…ë ¥ ê°€ëŠ¥, ê¸°ë³¸ê°’ì€ ë¹ˆì¹¸
        { title:"ID",   field:"id",   width:80,  hozAlign:"left", headerSort:true, editor:"input" },
        { title:"ì´ë¦„", field:"name",            hozAlign:"left", headerSort:true, editor:"input" },
        { title:"ë‚˜ì´", field:"age",  width:90,  hozAlign:"left", headerSort:true, editor:"input" },
        { title:"ë„ì‹œ", field:"city",            hozAlign:"left", headerSort:true, editor:"input" },
        { title:"ì…ì‚¬ì¼", field:"join",          hozAlign:"left", headerSort:true, editor:"input" },
        { title:"ì ìˆ˜", field:"score", width:90, hozAlign:"left", headerSort:true, editor:"input" },
      ],
    });

    // ---------------------------
    // Ctrl+C ë¡œ "ì„ íƒì˜ì—­ ë³µì‚¬"ë¥¼ ë°”ë¡œ ìˆ˜í–‰
    //  - ì¼ë¶€ í™˜ê²½ì—ì„œ ê¸°ë³¸ Ctrl+C ë™ì‘ì´ ë¨¹ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆì–´
    //    í…Œì´ë¸” ì˜ì—­ì˜ keydownì„ ê°€ë¡œì±„ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤.
    // ---------------------------
    const tableEl = document.getElementById("table");

    // í…Œì´ë¸”ì— í¬ì»¤ìŠ¤ ê°€ëŠ¥í•˜ë„ë¡ tabindex="0"ì„ ë¶€ì—¬í–ˆìŒ
    // í…Œì´ë¸”ì´ í¬ì»¤ìŠ¤ëœ ìƒíƒœì—ì„œ Ctrl/Cmd + C ë¥¼ ëˆ„ë¥´ë©´ ì„ íƒì˜ì—­ì„ ë³µì‚¬
    tableEl.addEventListener("keydown", (e) => {
      const isMac = navigator.platform.toUpperCase().indexOf("MAC") >= 0;
      const copyCombo = (isMac && e.metaKey && e.key.toLowerCase() === "c") ||
                        (!isMac && e.ctrlKey && e.key.toLowerCase() === "c");
      if (copyCombo) {
        // í˜„ì¬ ì„ íƒëœ ë²”ìœ„ë¥¼ í´ë¦½ë³´ë“œë¡œ ë³µì‚¬ (TSV í˜•íƒœ)
        table.copyToClipboard("selected");
        // ê¸°ë³¸ ì´ë²¤íŠ¸ë¥¼ ë§‰ì•„ ë‘ ë²ˆ ì²˜ë¦¬ë˜ëŠ” ê²ƒì„ ë°©ì§€
        e.preventDefault();
      }
    });

    // ---------------------------
    // íˆ´ë°”: ê²€ìƒ‰(ì‹¤ì‹œê°„ í•„í„°) â€” ì„ íƒì‚¬í•­
    // ---------------------------
    const $search = document.getElementById("search");
    $search.addEventListener("input", () => {
      const query = $search.value.trim();
      if (!query) {
        table.clearFilter(); // ê²€ìƒ‰ì–´ ì—†ìœ¼ë©´ í•„í„° í•´ì œ
      } else {
        // ì´ë¦„/ë„ì‹œ ì»¬ëŸ¼ OR í•„í„° (ë¶€ë¶„ì¼ì¹˜)
        table.setFilter([
          [
            { field:"name", type:"like", value:query },
            { field:"city", type:"like", value:query },
          ]
        ]);
      }
    });

    // ---------------------------
    // íˆ´ë°”: í–‰ ì¶”ê°€/ì‚­ì œ
    // ---------------------------
    document.getElementById("add-row").addEventListener("click", () => {
      // âœ… ë‚´ë¶€í‚¤ ìƒì„± (ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ timestamp+ë‚œìˆ˜ ì¡°í•©)
      const rid = "r" + Date.now().toString(36) + Math.random().toString(36).slice(2, 6);

      // âœ… í™”ë©´ìš© idëŠ” ë¹ˆì¹¸ìœ¼ë¡œ ì‹œì‘ â†’ â€œì´ìƒí•œ ê°’â€ ë“¤ì–´ê°€ì§€ ì•ŠìŒ
      table.addRow({ _rid: rid, id:"", name:"", age:"", city:"", join:"", score:"" }, true);
    });

    document.getElementById("del-row").addEventListener("click", () => {
      const selected = table.getSelectedRows();
      if (selected.length === 0) {
        alert("ì‚­ì œí•  í–‰ì„ ì„ íƒí•˜ì„¸ìš”.");
        return;
      }
      selected.forEach(r => r.delete());
    });

    // ---------------------------
    // íˆ´ë°”: CSV ë‚´ë³´ë‚´ê¸°
    // ---------------------------
    document.getElementById("export-csv").addEventListener("click", () => {
      table.download("csv", "table-export.csv");
    });
  </script>
</body>
</html>
